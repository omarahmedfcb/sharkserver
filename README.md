# SharkServer Authentication Setup

## المتطلبات
- Node.js 18 أو أحدث
- MongoDB قيد التشغيل
- ملف `.env` يحتوي على القيم:
  - `PORT` (اختياري، افتراضي 5000)
  - `MONGO_URI`
  - `JWT_SECRET`
  - `NEXT_PUBLIC_SAME_SITE` (اختياري، يسمح بالتبديل بين `lax` و `strict`)
  - `GOOGLE_CLIENT_ID` و`GOOGLE_CLIENT_SECRET`

## التثبيت والتشغيل
1. `npm install`
2. `npm run dev`

## الحماية والتحقق
- يتم فرض حدود المحاولات عبر `express-rate-limit` على مسارات `/auth/signup`, `/auth/signin`, `/auth/google`
- يتم التحقق من البريد وكلمة السر قبل إنشاء المستخدم
- كلمات السر يجب أن تحتوي على 8 أحرف على الأقل، مع حرف كبير ورقم
- عند استخدام Google OAuth يتم إنشاء كلمة سر عشوائية آمنة للمستخدم الجديد

## خطوات الاختبار
1. **تسجيل مستخدم جديد**: أرسل طلب POST إلى `/auth/signup` مع حقول الاسم والبريد وكلمة السر ونوع الحساب.
2. **محاولة بريد مكرر**: استخدم بريد موجود وتحقق من استجابة 409.
3. **دخول عبر البريد**: POST إلى `/auth/signin` ببريد صحيح/خاطئ للتحقق من رسائل الخطأ الموحدة.
4. **Google OAuth**: أرسل رمز التفويض (`code`) إلى `/auth/google` وتحقق من إنشاء الحساب أو تسجيل الدخول حسب الحالة.
5. **حماية التوكن**: بعد الحصول على التوكن عبر الـ Cookie، أرسل طلبًا إلى `/auth/me` وتأكد من رجوع بيانات المستخدم.

تأكد من مراقبة السجلات في الخادم (`console`) لمتابعة أي أخطاء أثناء التجربة.
